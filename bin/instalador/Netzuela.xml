<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi" xmlns:netfx="http://schemas.microsoft.com/wix/NetFxExtension">
	<Product Id="*" UpgradeCode="EC5E40BE-2F4A-453B-8026-24455F4F749E" Version="1.0.0" Language="3082" Codepage="1252" Name="Netzuela - Monitor de tiendas" Manufacturer="Zuliaworks C.A.">
        <Package InstallerVersion="300" Compressed="yes" Languages="3082" SummaryCodepage="1252" />
        <Media Id="1" Cabinet="Netzuela.cab" EmbedCab="yes" />

        <!-- Step 1: Define the directory structure -->
        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFilesFolder">
				<Directory Id="Zuliaworks" Name="Zuliaworks">
					<Directory Id="APPLICATIONFOLDER" Name="Netzuela" />
				</Directory>
            </Directory>
			<Directory Id="ProgramMenuFolder">
				<Directory Id="ApplicationProgramsFolder" Name="Netzuela" />
			</Directory>
        </Directory>

        <!-- Step 2: Add files to your installer package -->
        <DirectoryRef Id="APPLICATIONFOLDER">
            <Component Id="Netzuela.exe" Guid="810F0818-57C5-4D4D-B41D-BD39FDD0509D">
                <File Id="Netzuela.exe" Source="..\src\cliente\Zuliaworks.Netzuela.Valeria.Cliente.Presentacion\bin\Release\Netzuela.exe" KeyPath="yes" Checksum="yes" />
            </Component>
            <Component Id="AttachedCommandBehavior.dll" Guid="FAF42706-EE7C-4983-BFD9-A14BEEDC46AF">
                <File Id="AttachedCommandBehavior.dll" Source="..\src\cliente\Zuliaworks.Netzuela.Valeria.Cliente.Presentacion\bin\Release\AttachedCommandBehavior.dll" KeyPath="yes" />
            </Component>
			<Component Id="Comunes.dll" Guid="83A2DAA8-FCA6-46CA-8694-DE8EF07AD348">
                <File Id="Comunes.dll" Source="..\src\cliente\Zuliaworks.Netzuela.Valeria.Cliente.Presentacion\bin\Release\Comunes.dll" KeyPath="yes" />
            </Component>
			<Component Id="Datos.dll" Guid="CBE5F4B6-F5B2-4C85-B1E6-C01059776659">
                <File Id="Datos.dll" Source="..\src\cliente\Zuliaworks.Netzuela.Valeria.Cliente.Presentacion\bin\Release\Datos.dll" KeyPath="yes" />
            </Component>
			<Component Id="Logica.dll" Guid="763BD151-6C78-495F-B3AC-1B89F0E9F4FA">
                <File Id="Logica.dll" Source="..\src\cliente\Zuliaworks.Netzuela.Valeria.Cliente.Presentacion\bin\Release\Logica.dll" KeyPath="yes" />
            </Component>
			<Component Id="LogicaPresentacion.dll" Guid="A7900298-7E67-4B7F-8249-6D0E00F1AE8C">
                <File Id="LogicaPresentacion.dll" Source="..\src\cliente\Zuliaworks.Netzuela.Valeria.Cliente.Presentacion\bin\Release\LogicaPresentacion.dll" KeyPath="yes" />
            </Component>
			<Component Id="MvvmFoundation.Wpf.dll" Guid="A31805FD-810B-4AD5-A5BE-51B22A5E0DED">
                <File Id="MvvmFoundation.Wpf.dll" Source="..\src\cliente\Zuliaworks.Netzuela.Valeria.Cliente.Presentacion\bin\Release\MvvmFoundation.Wpf.dll" KeyPath="yes" />
            </Component>
			<Component Id="Preferencias.dll" Guid="BA6447EC-754F-4B55-965E-60A0C714254B">
                <File Id="Preferencias.dll" Source="..\src\cliente\Zuliaworks.Netzuela.Valeria.Cliente.Presentacion\bin\Release\Preferencias.dll" KeyPath="yes" />
            </Component>
			<Component Id="ServiceStack.Common.dll" Guid="25CC7679-A74E-40BB-B1FA-E2E7F78FD921">
                <File Id="ServiceStack.Common.dll" Source="..\src\cliente\Zuliaworks.Netzuela.Valeria.Cliente.Presentacion\bin\Release\ServiceStack.Common.dll" KeyPath="yes" />
            </Component>
			<Component Id="ServiceStack.Interfaces.dll" Guid="DB5C8776-A913-47EA-97CF-C094FEEA90A1">
                <File Id="ServiceStack.Interfaces.dll" Source="..\src\cliente\Zuliaworks.Netzuela.Valeria.Cliente.Presentacion\bin\Release\ServiceStack.Interfaces.dll" KeyPath="yes" />
            </Component>
			<Component Id="ServiceStack.Text.dll" Guid="C04AE19E-FE7D-41E4-A64D-3E8F2D814E90">
                <File Id="ServiceStack.Text.dll" Source="..\src\cliente\Zuliaworks.Netzuela.Valeria.Cliente.Presentacion\bin\Release\ServiceStack.Text.dll" KeyPath="yes" />
            </Component>
			<Component Id="Tipos.dll" Guid="73E50F9B-158C-4893-8D37-0745B337DE0B">
                <File Id="Tipos.dll" Source="..\src\cliente\Zuliaworks.Netzuela.Valeria.Cliente.Presentacion\bin\Release\Tipos.dll" KeyPath="yes" />
            </Component>
			<Component Id="Netzuela.exe.config" Guid="9BE67D77-46C3-4F43-877B-1764F7606FEA">
                <File Id="Netzuela.exe.config" Source="..\src\cliente\Zuliaworks.Netzuela.Valeria.Cliente.Presentacion\bin\Release\Netzuela.exe.config" KeyPath="yes" />
            </Component>
			<Component Id="Netzuela.exe.manifest" Guid="C2637FB2-B6AD-48D1-859B-9FF9B5DFD340">
                <File Id="Netzuela.exe.manifest" Source="..\src\cliente\Zuliaworks.Netzuela.Valeria.Cliente.Presentacion\bin\Release\Netzuela.exe.manifest" KeyPath="yes" />
            </Component>			
        </DirectoryRef>

		<DirectoryRef Id="ApplicationProgramsFolder">
			<Component Id="ApplicationShortcut" Guid="734A740C-BD58-4D50-817D-19D141BCC433">
				<Shortcut Id="ApplicationStartMenuShortcut" 
						  Name="Netzuela"
						  Description="Monitor de tiendas"
						  Target="[APPLICATIONFOLDER]Netzuela.exe"
						  WorkingDirectory="APPLICATIONFOLDER"
						  Icon="Logo.ico" IconIndex="0" />
				<Shortcut Id="UninstallProduct"             
						  Name="Desinstalar"
						  Target="[SystemFolder]msiexec.exe"
						  Arguments="/x [ProductCode]"
						  Description="Desinstala Netzuela" />
				<RemoveFolder Id="ApplicationProgramsFolder" On="uninstall" />
				<RegistryValue Root="HKCU" Key="Software\Zuliaworks\Netzuela" Name="installed" Type="integer" Value="1" KeyPath="yes" />
			</Component>
		</DirectoryRef>

		<PropertyRef  Id="NETFRAMEWORK40FULL" />
		
		<Condition Message="Esta aplicacion requiere .NET Framework 4.0. Instale el .NET Framework primero y luego ejecute esta instalacion.">
			<![CDATA[Installed OR NETFRAMEWORK40FULL]]>
		</Condition>
		
        <!-- Step 3: Tell WiX to install the files -->
        <Feature Id="Netzuela" Title="Netzuela" Level="1" Description="Instalador de Netzuela" Display="expand" ConfigurableDirectory="APPLICATIONFOLDER">
			<ComponentRef Id="Netzuela.exe" />
            <ComponentRef Id="AttachedCommandBehavior.dll" />
			<ComponentRef Id="Comunes.dll" />
			<ComponentRef Id="Datos.dll" />
			<ComponentRef Id="Logica.dll" />
			<ComponentRef Id="LogicaPresentacion.dll" />
			<ComponentRef Id="MvvmFoundation.Wpf.dll" />
			<ComponentRef Id="Preferencias.dll" />
			<ComponentRef Id="ServiceStack.Common.dll" />
			<ComponentRef Id="ServiceStack.Interfaces.dll" />
			<ComponentRef Id="ServiceStack.Text.dll" />
			<ComponentRef Id="Tipos.dll" />
			<ComponentRef Id="Netzuela.exe.config" />
			<ComponentRef Id="Netzuela.exe.manifest" />
			<ComponentRef Id="ApplicationShortcut" />
        </Feature>

		<UIRef Id="WixUI_InstallDir" />
		<UIRef Id="WixUI_ErrorProgressText" />
		<Icon Id="Logo.ico" SourceFile="..\src\cliente\Zuliaworks.Netzuela.Valeria.Cliente.Presentacion\Logo.ico" />
		<Property Id="ARPPRODUCTICON" Value="Logo.ico" />
		<Property Id="WIXUI_INSTALLDIR" Value="APPLICATIONFOLDER" />
		<!--<Property Id="ApplicationFolderName" Value="Netzuela" />
		<Property Id="WixAppFolder" Value="WixPerMachineFolder" />-->
	</Product>
</Wix>